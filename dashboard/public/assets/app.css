/* Kira Command Center â€” Design System */
:root {
  --bg-primary: #0a0a0f;
  --bg-secondary: #12121a;
  --bg-tertiary: #1a1a28;
  --bg-card: #16161f;
  --bg-hover: #1e1e2e;
  --text-primary: #e8e8f0;
  --text-secondary: #9898b0;
  --text-muted: #606078;
  --accent: #0055ff;
  --accent-glow: rgba(0,85,255,0.15);
  --accent-hover: #1a6aff;
  --p0: #ff3b3b;
  --p1: #ff9500;
  --p2: #ffd60a;
  --p3: #34c759;
  --on-track: #34c759;
  --behind: #ff9500;
  --at-risk: #ff3b3b;
  --border: #2a2a3a;
  --radius: 12px;
  --radius-sm: 8px;
  --sidebar-width: 240px;
  --sidebar-collapsed: 60px;
  --transition: 0.2s cubic-bezier(0.4,0,0.2,1);
}

* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif; background: var(--bg-primary); color: var(--text-primary); overflow-x: hidden; }
a { color: var(--accent); text-decoration: none; }
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

/* Sidebar */
.sidebar {
  position: fixed; left: 0; top: 0; bottom: 0;
  width: var(--sidebar-width); background: var(--bg-secondary);
  border-right: 1px solid var(--border); z-index: 100;
  display: flex; flex-direction: column;
  transition: width var(--transition);
}
.sidebar.collapsed { width: var(--sidebar-collapsed); }
.sidebar-header {
  padding: 20px 16px; display: flex; align-items: center; gap: 12px;
  border-bottom: 1px solid var(--border); min-height: 64px;
}
.sidebar-logo { width: 28px; height: 28px; border-radius: 8px; background: var(--accent); display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 14px; flex-shrink: 0; }
.sidebar-title { font-size: 16px; font-weight: 600; white-space: nowrap; overflow: hidden; }
.sidebar.collapsed .sidebar-title { display: none; }
.sidebar-toggle {
  position: absolute; right: -12px; top: 20px; width: 24px; height: 24px;
  border-radius: 50%; background: var(--bg-tertiary); border: 1px solid var(--border);
  color: var(--text-secondary); cursor: pointer; display: flex; align-items: center; justify-content: center;
  font-size: 12px; z-index: 101; transition: var(--transition);
}
.sidebar-toggle:hover { background: var(--accent); color: white; }

.nav-items { flex: 1; padding: 12px 8px; display: flex; flex-direction: column; gap: 2px; }
.nav-item {
  display: flex; align-items: center; gap: 12px; padding: 10px 12px;
  border-radius: var(--radius-sm); cursor: pointer; color: var(--text-secondary);
  transition: var(--transition); white-space: nowrap; font-size: 14px; position: relative;
}
.nav-item:hover { background: var(--bg-hover); color: var(--text-primary); }
.nav-item.active { background: var(--accent-glow); color: var(--accent); font-weight: 500; }
.nav-item .icon { font-size: 18px; width: 24px; text-align: center; flex-shrink: 0; }
.nav-item .label { overflow: hidden; }
.sidebar.collapsed .nav-item .label { display: none; }
.nav-item .shortcut {
  margin-left: auto; font-size: 10px; color: var(--text-muted);
  background: var(--bg-tertiary); padding: 2px 6px; border-radius: 4px; font-family: monospace;
}
.sidebar.collapsed .nav-item .shortcut { display: none; }

.sidebar-footer { padding: 12px 16px; border-top: 1px solid var(--border); font-size: 12px; color: var(--text-muted); }
.sidebar.collapsed .sidebar-footer { display: none; }

/* Main content */
.main {
  margin-left: var(--sidebar-width); min-height: 100vh; padding: 24px 32px;
  transition: margin-left var(--transition);
}
.sidebar.collapsed ~ .main { margin-left: var(--sidebar-collapsed); }

/* Page transitions */
.page { animation: fadeIn 0.25s ease; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

/* Cards */
.card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 20px; transition: var(--transition);
}
.card:hover { border-color: #3a3a4a; }
.card-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; }
.card-title { font-size: 14px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; }

/* Grid */
.grid { display: grid; gap: 16px; }
.grid-2 { grid-template-columns: repeat(2, 1fr); }
.grid-3 { grid-template-columns: repeat(3, 1fr); }
.grid-4 { grid-template-columns: repeat(4, 1fr); }

/* Page header */
.page-header { margin-bottom: 24px; }
.page-header h1 { font-size: 28px; font-weight: 700; margin-bottom: 4px; }
.page-header .subtitle { color: var(--text-secondary); font-size: 14px; }

/* Health rings */
.health-ring {
  width: 80px; height: 80px; position: relative;
}
.health-ring svg { transform: rotate(-90deg); }
.health-ring circle { fill: none; stroke-width: 6; }
.health-ring .bg { stroke: var(--bg-tertiary); }
.health-ring .progress { stroke-linecap: round; transition: stroke-dashoffset 0.8s ease; }
.health-ring .label {
  position: absolute; inset: 0; display: flex; align-items: center; justify-content: center;
  font-size: 12px; font-weight: 600;
}

/* Status badge */
.badge {
  display: inline-flex; align-items: center; gap: 4px; padding: 3px 10px;
  border-radius: 20px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.3px;
}
.badge-ok { background: rgba(52,199,89,0.15); color: var(--on-track); }
.badge-warn { background: rgba(255,149,0,0.15); color: var(--behind); }
.badge-error { background: rgba(255,59,59,0.15); color: var(--at-risk); }

/* Task priorities */
.priority-0 { border-left: 3px solid var(--p0); }
.priority-1 { border-left: 3px solid var(--p1); }
.priority-2 { border-left: 3px solid var(--p2); }
.priority-3 { border-left: 3px solid var(--p3); }

.priority-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; }
.priority-dot-0 { background: var(--p0); }
.priority-dot-1 { background: var(--p1); }
.priority-dot-2 { background: var(--p2); }
.priority-dot-3 { background: var(--p3); }

/* Company tags */
.company-tag {
  display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;
}
.tag-IAM { background: rgba(88,86,214,0.2); color: #8886d6; }
.tag-OttoGen { background: rgba(0,199,190,0.2); color: #00c7be; }
.tag-ZenithCred { background: rgba(255,149,0,0.2); color: #ff9500; }
.tag-Chimera { background: rgba(175,82,222,0.2); color: #af52de; }
.tag-CuttingEdge { background: rgba(255,59,48,0.2); color: #ff3b30; }
.tag-SentinAgro { background: rgba(52,199,89,0.2); color: #34c759; }
.tag-Abura { background: rgba(255,214,10,0.2); color: #ffd60a; }

/* Progress bar */
.progress-bar { height: 8px; background: var(--bg-tertiary); border-radius: 4px; overflow: hidden; }
.progress-fill { height: 100%; border-radius: 4px; transition: width 0.8s ease; }
.progress-on-track { background: var(--on-track); }
.progress-behind { background: var(--behind); }
.progress-at-risk { background: var(--at-risk); }

/* Kanban */
.kanban { display: flex; gap: 16px; overflow-x: auto; padding-bottom: 8px; }
.kanban-column { min-width: 300px; flex: 1; }
.kanban-column-header {
  padding: 12px 16px; background: var(--bg-tertiary); border-radius: var(--radius-sm) var(--radius-sm) 0 0;
  font-size: 13px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;
  display: flex; align-items: center; justify-content: space-between;
}
.kanban-column-header .count { background: var(--bg-card); padding: 2px 8px; border-radius: 10px; font-size: 11px; }
.kanban-cards { background: var(--bg-secondary); border-radius: 0 0 var(--radius-sm) var(--radius-sm); padding: 8px; min-height: 100px; display: flex; flex-direction: column; gap: 8px; }
.kanban-card {
  padding: 12px; background: var(--bg-card); border-radius: var(--radius-sm);
  border: 1px solid var(--border); cursor: pointer; transition: var(--transition);
}
.kanban-card:hover { border-color: var(--accent); transform: translateY(-1px); }
.kanban-card-title { font-size: 13px; font-weight: 500; margin-bottom: 8px; }
.kanban-card-meta { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
.kanban-card-due { font-size: 11px; color: var(--text-muted); }

/* Table view */
.table-view { width: 100%; border-collapse: collapse; }
.table-view th { text-align: left; padding: 10px 12px; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-muted); border-bottom: 1px solid var(--border); }
.table-view td { padding: 10px 12px; border-bottom: 1px solid var(--border); font-size: 13px; }
.table-view tr:hover td { background: var(--bg-hover); }

/* Filters */
.filters { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 16px; }
.filter-btn {
  padding: 6px 14px; border-radius: 20px; border: 1px solid var(--border);
  background: transparent; color: var(--text-secondary); cursor: pointer; font-size: 12px;
  transition: var(--transition);
}
.filter-btn:hover { border-color: var(--accent); color: var(--text-primary); }
.filter-btn.active { background: var(--accent); color: white; border-color: var(--accent); }

/* View toggle */
.view-toggle { display: flex; background: var(--bg-tertiary); border-radius: var(--radius-sm); overflow: hidden; }
.view-toggle button {
  padding: 6px 14px; border: none; background: transparent; color: var(--text-secondary);
  cursor: pointer; font-size: 13px; transition: var(--transition);
}
.view-toggle button.active { background: var(--accent); color: white; }

/* Knowledge graph */
.graph-container { position: relative; background: var(--bg-secondary); border-radius: var(--radius); border: 1px solid var(--border); overflow: hidden; }
.graph-svg { width: 100%; height: 600px; }
.graph-sidebar {
  position: absolute; right: 0; top: 0; bottom: 0; width: 360px;
  background: var(--bg-card); border-left: 1px solid var(--border);
  padding: 20px; overflow-y: auto; transform: translateX(100%);
  transition: transform var(--transition);
}
.graph-sidebar.open { transform: translateX(0); }
.graph-controls {
  position: absolute; top: 12px; left: 12px; display: flex; gap: 8px; z-index: 10;
}
.graph-legend {
  position: absolute; bottom: 12px; left: 12px; display: flex; gap: 12px; flex-wrap: wrap;
  background: rgba(10,10,15,0.8); padding: 8px 12px; border-radius: var(--radius-sm); z-index: 10;
}
.legend-item { display: flex; align-items: center; gap: 4px; font-size: 11px; color: var(--text-secondary); }
.legend-dot { width: 8px; height: 8px; border-radius: 50%; }

/* Sparkline */
.sparkline { display: inline-block; vertical-align: middle; }

/* Quick actions */
.quick-actions { display: flex; gap: 8px; flex-wrap: wrap; }
.quick-action {
  padding: 8px 16px; background: var(--bg-tertiary); border: 1px solid var(--border);
  border-radius: var(--radius-sm); color: var(--text-primary); cursor: pointer;
  font-size: 13px; transition: var(--transition); display: flex; align-items: center; gap: 6px;
}
.quick-action:hover { border-color: var(--accent); background: var(--accent-glow); }

/* Skeleton loading */
.skeleton { background: linear-gradient(90deg, var(--bg-tertiary) 25%, var(--bg-hover) 50%, var(--bg-tertiary) 75%); background-size: 200% 100%; animation: shimmer 1.5s infinite; border-radius: var(--radius-sm); }
@keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }

/* Episode list */
.episode-item { padding: 10px 0; border-bottom: 1px solid var(--border); display: flex; gap: 12px; align-items: flex-start; }
.episode-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--accent); margin-top: 6px; flex-shrink: 0; }
.episode-time { font-size: 11px; color: var(--text-muted); white-space: nowrap; min-width: 50px; }
.episode-text { font-size: 13px; color: var(--text-secondary); }

/* Responsive */
@media (max-width: 768px) {
  .sidebar { width: var(--sidebar-collapsed); }
  .sidebar .sidebar-title, .sidebar .nav-item .label, .sidebar .nav-item .shortcut, .sidebar .sidebar-footer { display: none; }
  .main { margin-left: var(--sidebar-collapsed); padding: 16px; }
  .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
  .kanban { flex-direction: column; }
  .kanban-column { min-width: unset; }
  .graph-sidebar { width: 100%; }
}

/* Chat */
.chat-page .chat-container { display:flex; flex-direction:column; height:calc(100vh - 160px); background:var(--bg-primary); border-radius:var(--radius); overflow:hidden; }
.chat-messages { flex:1; overflow-y:auto; padding:16px 48px; display:flex; flex-direction:column; gap:2px; background:radial-gradient(ellipse at 50% 0%,rgba(0,85,255,.03) 0%,transparent 70%); }
.chat-date-sep { text-align:center; padding:16px 0 10px; }
.chat-date-sep span { background:rgba(0,0,0,.5); color:var(--text-muted); font-size:.72rem; font-weight:500; padding:4px 12px; border-radius:10px; letter-spacing:.3px; }
/* --- Seamless chat layout (Slack/Discord style) --- */
.chat-msg-row {
  display:flex; gap:12px; align-items:flex-start; width:100%;
  padding:6px 16px; margin-bottom:2px; animation:chatMsgIn .2s ease-out;
  border-radius:4px; transition:background .15s;
}
.chat-msg-row:hover { background:rgba(255,255,255,.025); }
.chat-msg-row.out, .chat-msg-row.in { align-self:stretch; flex-direction:row; }
@keyframes chatMsgIn { from{opacity:0;transform:translateY(4px)} to{opacity:1;transform:translateY(0)} }

.chat-avatar { width:36px; height:36px; border-radius:8px; flex-shrink:0; display:flex; align-items:center; justify-content:center; font-size:.8rem; font-weight:700; color:#fff; margin-top:1px; }
.chat-avatar-kira { background:linear-gradient(135deg,#0055ff,#0040cc); }
.chat-avatar-otto { background:linear-gradient(135deg,#7c3aed,#5b21b6); }

.chat-msg-bubble { flex:1; padding:0; border-radius:0; position:relative; min-width:0; word-break:break-word; background:none!important; border:none!important; box-shadow:none!important; overflow:hidden; max-width:100%; }

.chat-msg-sender { font-size:.82rem; font-weight:700; display:inline; }
.chat-msg-row.in .chat-msg-sender { color:#5b9cf6; }
.chat-msg-row.out .chat-msg-sender { color:#c4a0ff; }

.chat-msg-meta { display:inline; margin-left:8px; }
.chat-msg-time { font-size:.7rem; color:rgba(255,255,255,.25); font-family:monospace; }
.chat-msg-row.out .chat-msg-time { color:rgba(255,255,255,.25); }
.chat-msg-type { font-size:.6rem; background:rgba(255,255,255,.06); padding:1px 5px; border-radius:3px; color:rgba(255,255,255,.2); font-family:monospace; margin-left:6px; }

.chat-msg-content { font-size:.9rem; line-height:1.6; color:var(--text-primary); margin-top:2px; }
.chat-msg-content p { margin:0 0 6px; } .chat-msg-content p:last-child { margin:0; }
.chat-msg-content strong { color:#fff; }
.chat-msg-content pre { background:rgba(0,0,0,.35); padding:12px 14px; border-radius:6px; overflow-x:auto; margin:8px 0; font-size:.8rem; border:1px solid rgba(255,255,255,.05); }
.chat-msg-content code { font-family:'JetBrains Mono',monospace; background:rgba(0,0,0,.25); padding:1px 5px; border-radius:3px; font-size:.82rem; }
.chat-msg-content ul, .chat-msg-content ol { margin:4px 0 8px; padding-left:20px; }
.chat-msg-content li { margin:2px 0; }
.chat-msg-content blockquote { border-left:3px solid var(--accent); margin:8px 0; padding:4px 14px; color:var(--text-secondary); background:rgba(0,85,255,.04); border-radius:0 4px 4px 0; }
.chat-msg-content h1,.chat-msg-content h2,.chat-msg-content h3 { font-size:.95rem; margin:10px 0 4px; color:#fff; font-weight:700; }
.chat-msg-content table { border-collapse:collapse; margin:8px 0; font-size:.82rem; width:100%; }
.chat-msg-content th,.chat-msg-content td { border:1px solid rgba(255,255,255,.08); padding:6px 10px; text-align:left; }
.chat-msg-content th { background:rgba(0,0,0,.2); color:#fff; font-weight:600; }
.chat-msg-content a { color:#5b9cf6; text-decoration:none; }
.chat-msg-content a:hover { text-decoration:underline; }
.chat-msg-content img { max-width:100%; border-radius:6px; margin:6px 0; }
.chat-input-bar { display:flex; gap:10px; padding:12px 16px; border-top:1px solid rgba(255,255,255,.05); background:rgba(10,10,26,.6); }
.chat-input-bar textarea { flex:1; background:var(--bg-tertiary); border:1px solid rgba(255,255,255,.06); color:var(--text-primary); padding:10px 16px; border-radius:18px; font-family:inherit; font-size:.9rem; resize:none; outline:none; min-height:42px; max-height:120px; transition:border-color .2s,box-shadow .2s; }
.chat-input-bar textarea:focus { border-color:rgba(0,85,255,.4); box-shadow:0 0 0 3px rgba(0,85,255,.08); }
.chat-input-bar textarea::placeholder { color:var(--text-muted); }
.chat-send-btn { background:var(--accent); color:#fff; border:none; width:42px; height:42px; border-radius:50%; cursor:pointer; font-size:1.1rem; display:flex; align-items:center; justify-content:center; align-self:flex-end; transition:transform .15s,box-shadow .15s; box-shadow:0 2px 8px rgba(0,85,255,.3); }
.chat-send-btn:hover { transform:scale(1.08); box-shadow:0 4px 16px rgba(0,85,255,.4); }
.chat-raw-toggle { display:flex; align-items:center; gap:6px; font-size:.8rem; color:var(--text-secondary); cursor:pointer; }
.chat-raw-toggle input { accent-color:var(--accent); }
.chat-typing { padding:8px 16px 4px 64px; font-size:.8rem; color:var(--text-muted); display:flex; align-items:center; gap:8px; }
.typing-dots span { display:inline-block; width:6px; height:6px; border-radius:50%; background:var(--text-muted); animation:typingBounce 1.2s infinite; }
.typing-dots span:nth-child(2) { animation-delay:.2s; }
.typing-dots span:nth-child(3) { animation-delay:.4s; }
@keyframes typingBounce { 0%,60%,100%{transform:translateY(0)} 30%{transform:translateY(-4px)} }

/* Status badge button */
.status-badge {
  display: inline-block; padding: 2px 8px; border-radius: 10px; font-size: 10px; font-weight: 600;
  text-transform: uppercase; letter-spacing: 0.3px; border: none; cursor: pointer; transition: var(--transition);
}
.status-badge:hover { filter: brightness(1.3); transform: scale(1.05); }
.status-todo { background: rgba(255,59,59,0.15); color: var(--at-risk); }
.status-in-progress { background: rgba(255,149,0,0.15); color: var(--behind); }
.status-done { background: rgba(52,199,89,0.15); color: var(--on-track); }

/* Kanban card header row */
.kanban-card-header-row { display: flex; justify-content: space-between; align-items: flex-start; gap: 8px; margin-bottom: 8px; }
.kanban-card-header-row .kanban-card-title { margin-bottom: 0; }

/* Task detail expand */
.task-detail { margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border); }
.task-detail-field { font-size: 12px; color: var(--text-secondary); margin-bottom: 4px; }
.task-detail-field strong { color: var(--text-primary); }

/* Personal company tag */
.tag-Personal { background: rgba(90,200,250,0.2); color: #5ac8fa; }

/* VDR */
.vdr-breadcrumb { display: flex; align-items: center; gap: 4px; margin-bottom: 16px; font-size: 13px; flex-wrap: wrap; }
.vdr-crumb { color: var(--accent); cursor: pointer; padding: 2px 4px; border-radius: 4px; }
.vdr-crumb:hover { background: var(--accent-glow); }
.vdr-sep { color: var(--text-muted); }
.vdr-file-list { display: flex; flex-direction: column; }
.vdr-file-item { display: flex; align-items: center; gap: 12px; padding: 10px 12px; border-bottom: 1px solid var(--border); cursor: pointer; transition: var(--transition); }
.vdr-file-item:hover { background: var(--bg-hover); }
.vdr-file-item:last-child { border-bottom: none; }
.vdr-file-icon { font-size: 18px; width: 24px; text-align: center; flex-shrink: 0; }
.vdr-file-name { flex: 1; font-size: 13px; font-weight: 500; }
.vdr-file-size { font-size: 11px; color: var(--text-muted); min-width: 60px; text-align: right; }
.vdr-file-date { font-size: 11px; color: var(--text-muted); min-width: 80px; text-align: right; }
.vdr-markdown { font-size: 14px; line-height: 1.7; color: var(--text-secondary); }
.vdr-markdown h1, .vdr-markdown h2, .vdr-markdown h3 { color: var(--text-primary); margin: 16px 0 8px; }
.vdr-markdown p { margin-bottom: 12px; }
.vdr-markdown code { background: var(--bg-tertiary); padding: 1px 5px; border-radius: 4px; font-size: 13px; }
.vdr-markdown pre { background: var(--bg-tertiary); padding: 12px; border-radius: 8px; overflow-x: auto; margin: 8px 0; }
.vdr-markdown ul, .vdr-markdown ol { padding-left: 20px; margin-bottom: 12px; }
.vdr-markdown a { color: var(--accent); }
.vdr-plaintext { font-size: 13px; color: var(--text-secondary); white-space: pre-wrap; word-break: break-word; margin: 0; background: transparent; }

/* Search input */
.search-input {
  padding: 8px 14px; background: var(--bg-tertiary); border: 1px solid var(--border);
  border-radius: var(--radius-sm); color: var(--text-primary); font-size: 13px;
  outline: none; transition: var(--transition); width: 240px;
}
.search-input:focus { border-color: var(--accent); }
.search-input::placeholder { color: var(--text-muted); }

/* Goal card */
.goal-card { padding: 20px; }
.goal-value { font-size: 28px; font-weight: 700; margin: 8px 0; }
.goal-target { font-size: 12px; color: var(--text-muted); }
